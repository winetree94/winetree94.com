---
import { ghost } from "@/lib/ghost";
import { SUPPORTED_LANGUAGES } from "@/lib/language";
import type { GetStaticPaths, InferGetStaticPropsType } from "astro";
import BlogArticle from "@/components/BlogArticle.astro";

export const getStaticPaths = (async () => {
  const res = await Promise.all(
    Object.values(SUPPORTED_LANGUAGES).map(async (lang) => {
      const page = await ghost.pages.read({
        slug: `${lang}-else`,
      });
      if (!page) {
        throw new Error(`Page not found for language ${lang}`);
      }
      return {
        props: {
          page: page,
        },
        params: {
          lang: lang,
        },
      };
    }),
  );
  return res.flat();
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;
---

<BlogArticle
  useAuthor={false}
  slug={"else"}
  lang={Astro.params.lang}
  post={Astro.props.page}
/>
