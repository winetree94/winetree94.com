---
import { javascript } from '@codemirror/lang-javascript';
import { EditorState } from '@codemirror/state';
import { EditorView, basicSetup } from 'codemirror';
import IconButton from './icon/IconButton.astro';

type Props = {
  code: string;
};

const props = Astro.props as Props;

const state = EditorState.create({
  extensions: [basicSetup, javascript()],
  doc: props.code,
  // parent: EDITOR_ROOT,
});
---

<div
  id="codemirror-editor"
  class="max-h-[400px] border border-black-300 rounded flex flex-col"
>
  <!-- temporary render -->
  <pre class="editor-temp hidden">{props.code}</pre>
  <div class="flex justify-between shadow p-1">
    <span class="mb-0 flex items-center ml-4">Code Runnder</span>
    <div class="flex">
      <IconButton icon="ri-search-line" size="sm" />
    </div>
  </div>
  <div class="flex overflow-hidden">
    <div class="editor-root w-1/2 overflow-y-auto"></div>
    <div class="w-1/2  overflow-y-auto">
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
      <p>alskdjfasdlfk</p>
    </div>
  </div>
</div>

<script>
  import { javascript } from "@codemirror/lang-javascript";
  import { EditorView, basicSetup } from "codemirror";

  const TEMP = document.querySelector(".editor-temp") as HTMLPreElement;
  const EDITOR_ROOT = document.querySelector(".editor-root") as HTMLDivElement;

  const code = TEMP.textContent || "";
  TEMP.remove();

  const editor = new EditorView({
    extensions: [basicSetup, javascript()],
    parent: EDITOR_ROOT,
    doc: code,
  });
</script>
